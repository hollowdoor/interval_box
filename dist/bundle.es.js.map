{"version":3,"file":"bundle.es.js","sources":["../src/frames.js","../src/now.js","../src/index.js"],"sourcesContent":["const requestFrame = typeof window !== 'undefined'\n? window.requestAnimationFrame\n? window.requestAnimationFrame\n: window.setImmediate\n? window.setImmediate\n: (cb)=>setTimeout(cb, 0)\n: setImmediate\n? setImmediate\n: (cb)=>setTimeout(cb, 0);\n\nconst cancelFrame = typeof window !== 'undefined'\n? window.cancelAnimationFrame\n? window.cancelAnimationFrame\n: window.clearImmediate\n? window.clearImmediate\n: clearTimeout\n: clearImmediate\n? clearImmediate\n: clearTimeout;\n\nexport { requestFrame, cancelFrame }\n","const start = typeof performance !== 'undefined' && performance.now\n? performance.timing.navigationStart\n: null;\n\nconst now = typeof performance !== 'undefined' && performance.now\n? ()=>start + performance.now()\n: Date.now\n? Date.now\n: ()=>new Date().getTime();\n\nexport default now;\n","import rawObject from 'raw-object';\nimport { requestFrame, cancelFrame } from './frames.js';\nimport now from './now.js';\nconst max = Math.max;\n\nexport function clock(interval, {\n    tick = null,\n    sync = 1000,\n    precise = false,\n    stop = ()=>{},\n    pause = ()=>{}\n} = {}){\n\n    let running = false,\n        paused = false,\n        timeoutID = null,\n        //Allow setting amount of ticks\n        stopOn = null,\n        startTime,\n        count = 0,\n        //The precise-ish time\n        base = null,\n        request = precise\n        ? requestFrame : setTimeout,\n        cancel = precise\n        ? cancelFrame : clearTimeout;\n\n    if(typeof tick !== 'function'){\n        throw new Error(`${tick} is not a function`);\n    }\n\n    const timer = rawObject({\n        stop(){\n            //Full stop\n            if(timeoutID !== null){\n                running = false;\n                cancel(timeoutID);\n                timeoutID = null;\n                stop.call(this, base);\n            }\n            return this;\n        },\n        pause(){\n            //A pause is just a boolean\n            //that stops tick() calls\n            paused = true;\n            pause.call(this, base);\n            return this;\n        },\n        start(times){\n            stopOn = isNaN(times)\n            ? stopOn : max(times, 1);\n            count = 0;\n\n            if(paused){\n                //The timer is already running\n                paused = false;\n                return this;\n            }\n\n            base = startTime = now();\n            if(sync) this.sync(sync);\n            paused = false;\n            running = true;\n\n            next();\n            return this;\n        },\n        sync(syncTo, forward = 1){\n            sync = syncTo;\n            forward = sync * max(forward, 1);\n            //Synchronize interval\n            //to rounded interval\n            if(!base){\n                base = startTime = startTime - (startTime % sync) + forward;\n            }else{\n                startTime = startTime - (startTime % sync) + forward;\n                base = base - (base % sync) + forward;\n            }\n        }\n    });\n\n    function next(){\n        if(!running) return;\n        timeoutID = request(next, 0);\n        let time = now();\n        //Compensate for drifting,\n        //and processing time\n        if(time - base < -1) return;\n        //Stabilize the timer interval\n        base += interval;\n        //While paused the interval still\n        //progresses without calling tick()\n        if(paused) return;\n\n        ++count;\n\n        if(stopOn && count >= stopOn){\n            return timer.stop();\n        }\n\n        tick.call(timer, base, time);\n    }\n\n    return timer;\n}\n"],"names":["const","let"],"mappings":"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"}